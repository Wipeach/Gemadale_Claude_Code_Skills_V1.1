---
name: real-estate-ppt-generator
description: 房地产项目分析和PPT自动生成工具，用于处理住房、土地、供应、成交等数据，生成专业的房地产项目分析报告PPT。支持开盘分析、客户分析、周边信息分析、户型图分析等功能，并自动将结果整合到PowerPoint演示文稿中。
---

# 房地产项目分析与PPT自动生成技能

## 概述

本技能提供完整的房地产项目数据分析和自动化PPT生成能力。通过输入项目名称，系统会自动处理各类房地产数据（住房、土地、供应、成交等），进行多维度分析，并生成专业的PowerPoint演示文稿。

## 功能特性

- **住房数据解析**：解析项目基本信息
- **土地数据解析**：处理土地相关信息  
- **供应数据分析**：分析房地产供应情况
- **成交数据分析**：处理成交数据并生成可视化图表
- **开盘分析**：专门的开盘（Kaipan）数据分析
- **户型图分析**：通过LLM分析户型图片
- **客户分析**：分析客户数据并生成地域来源饼图
- **周边信息分析**：分析项目周边环境信息
- **PPT自动生成**：创建专业模板并自动填充所有分析结果

## 使用方法

### 基本使用

运行主脚本并输入项目名称：

```bash
cd /root/clawd/skills/real-estate-ppt-generator/scripts
python3 main_pipeline.py
```

系统会提示输入项目名称，然后自动执行完整的分析流程。

### 数据准备

在运行前，请确保在 `resources/working_data/{项目名称}_{日期}/` 目录下准备好以下文件：

- `{项目名称}_基本信息.txt` - 项目基本信息文件
- `{项目名称}_土地信息.txt` - 土地信息文件  
- `{项目名称}_供应明细底表.xlsx` - 供应数据Excel文件
- `{项目名称}_成交分析结果.xlsx` - 成交分析Excel文件
- `{项目名称}_开盘信息.xlsx` - 开盘信息Excel文件（可选）

### 输出结果

生成的PPT文件将保存在工作目录中，包含以下页面：

- **第1页**：项目封面和基本信息
- **第2页**：土地信息、供应数据、开盘分析表格和文字
- **第3页**：户型分析图片和文本说明
- **第4页**：装修表格和周边信息总结
- **第5页**：客户分析文本和地域来源饼图

## 目录结构

```
real-estate-ppt-generator/
├── SKILL.md                    # 技能说明文档
├── scripts/                    # 执行脚本
│   ├── main_pipeline.py        # 主执行流程
│   ├── data_processor_*.py     # 各类数据处理器
│   └── pptx_gen_*.py           # PPT生成模块
└── resources/                  # 资源文件
    ├── images/                 # 图片资源
    └── working_data/           # 工作数据目录
        └── {项目名}_{日期}/    # 项目特定数据目录
```

## 依赖要求

- Python 3.6+
- python-pptx 库
- pandas 库  
- openpyxl 库
- matplotlib 库（用于图表生成）
- 其他相关数据分析库

## 故障排除

### 常见问题

1. **文件路径错误**：确保工作数据文件放在正确的目录结构中
2. **缺少依赖库**：安装所需的Python包
3. **数据格式不匹配**：检查输入文件格式是否符合预期

### 调试模式

脚本包含详细的日志输出，每个步骤都会显示执行状态。如果某个模块失败，系统会继续执行其他模块并记录错误信息。

## 扩展性

本技能采用模块化设计，可以轻松添加新的分析功能：

- 添加新的数据处理器：在 `scripts/` 目录下创建新的 `data_processor_*.py` 文件
- 添加新的PPT生成模块：创建新的 `pptx_gen_*.py` 文件  
- 修改主流程：在 `main_pipeline.py` 中集成新模块

## 注意事项

- 项目名称不能包含特殊字符，建议使用字母、数字和中文
- 确保输入数据文件的编码格式为UTF-8
- 生成的PPT文件会覆盖同名文件，请注意备份
- 某些分析功能依赖于LLM服务，需要确保网络连接正常

## 示例工作流

1. 准备项目数据文件到 `resources/working_data/项目名称_日期/` 目录
2. 运行 `python3 scripts/main_pipeline.py`
3. 输入项目名称（如：金地项目）
4. 等待系统完成所有分析步骤
5. 在工作目录中查看生成的PPT文件

本技能适用于房地产分析师、项目经理、销售团队等需要快速生成专业项目分析报告的场景。